
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet/less" type="text/css" href="/theme/stylesheet/style.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>

  <link rel="stylesheet" type="text/css" href="/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/font-awesome.min.css">







<meta name="author" content="Amir Nasri" />
<meta name="description" content="In this post, we explore processing and analyzing social media commentary to detect insults." />
<meta name="keywords" content="">

<meta property="og:site_name" content="Data Science Passion"/>
<meta property="og:title" content="Detecting insults in Social Media"/>
<meta property="og:description" content="In this post, we explore processing and analyzing social media commentary to detect insults."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="/insults-kaggle.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-06-08 20:00:00-07:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="/author/amir-nasri.html">
<meta property="article:section" content="Data science posts"/>
<meta property="og:image" content="">

  <title>Data Science Passion &ndash; Detecting insults in Social Media</title>

</head>
<body>
  <main>


<article class="single">
  <header>
      
    <h1 id="insults-kaggle"></h1>
    <p class="posted_on">
    </p>
  </header>


  <div>
    <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers:  */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Insults--detection-in-Social-Media">Insults  detection in Social Media<a class="anchor-link" href="#Insults--detection-in-Social-Media">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this article, we consider the problem of detecting insults in social media comments. This is an important problem from a practical point of views since there are many social media sites such as youtube, yelp, etc, that are interested in detecting and filtering out comments that involve insults especially to other users. We use the data provided in <a href="https://www.kaggle.com/c/detecting-insults-in-social-commentary">this</a> competition hosted by Kaggle. We follow the same setup and use the same performance criterion as in the competition to be able to compare our results to the winners of the competition.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Data-and-Problem-Setup">The Data and Problem Setup<a class="anchor-link" href="#The-Data-and-Problem-Setup">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this competition, first "train.csv" was made available and contestants were ask to submit their preliminary models. Here is a random sample of the train data:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'max_colwidth'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/train.csv"</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt"></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Insult</th>
<th>Date</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<th>3223</th>
<td>0</td>
<td>20120619233439Z</td>
<td>"@Lyoness....I was thinking the same thing how can you not know where your money is gonna...$2 millon is a lot of money hands down....I truly believe that k Michelle like others our using their pass and now relationship to get paid she's bitter that Memphiz is with Toya now....why didn't she say anything about all this last year???? When and Toya and Memphiz got married why she waited for a reality show!!!!! Please Help me out because I don't get it!!!!!"</td>
</tr>
<tr>
<th>1226</th>
<td>0</td>
<td>20120619052850Z</td>
<td>"courtt239 I'm a cat no shit your dog doesn't like me"</td>
</tr>
<tr>
<th>2720</th>
<td>0</td>
<td>NaN</td>
<td>"\\xc2\\xa0Freedom ain\\'t free... suck it up, quit whining, and make the effort to get the free ID...\\n\\nIf "people will just not go through it", then they don\\'t want to vote badly enough... We\\'re talking minimal standards here--kinda borderline pathetic!"</td>
</tr>
<tr>
<th>69</th>
<td>0</td>
<td>20120527153941Z</td>
<td>"you better hope because the Marlins have a history of giving up their superstars"</td>
</tr>
<tr>
<th>3391</th>
<td>1</td>
<td>20120618194243Z</td>
<td>"do you have any proof that Romney stole anything? Or are you just a stupid libtard troll?"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The public and private leaderboad evaluation at this first stage was done on a test data set that later was made available as "test_with_solutions.csv". The contestants then submitted their final models which were evaluated on a verification set. This set was provided after the competition was disclosed as "impermium_verification_labels.csv".</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">test_with_solutions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/test_with_solutions.csv"</span><span class="p">)</span>
<span class="n">verfication_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/impermium_verification_labels.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we are interested in building the final model, we need to combine the "train" and "test_with_solutions" data sets and use that as training data:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">train_total</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">test_with_solutions</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After building our model we will evaluate the model performance on the "verification" data set above which serves as test data. Here is a glimpse of our training data:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">train_total</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt"></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>index</th>
<th>Insult</th>
<th>Date</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<th>1959</th>
<td>1959</td>
<td>1</td>
<td>20120529105937Z</td>
<td>"You're analysis is exceptionally American. And by that I mean it's entirely grounded in fact-challenged star-spangled retardation- entirely voluntary in nature."</td>
</tr>
<tr>
<th>2450</th>
<td>2450</td>
<td>0</td>
<td>20120530022806Z</td>
<td>"Again:\xa0 I wouldn't count on it.\n\nAnyone who continues to support the current empty suit is either totally deluded or a_traitor."</td>
</tr>
<tr>
<th>5844</th>
<td>1897</td>
<td>1</td>
<td>20120528034620Z</td>
<td>"FANS ARE SOOOO BLIND DUMB. refs handed game to spurs??? THUNDER MADE two more free throws than the spurs (19 to 17) AND SPURS STILL WON! shut it haters"</td>
</tr>
<tr>
<th>6376</th>
<td>2429</td>
<td>0</td>
<td>20120528043920Z</td>
<td>"I don't know what to think about LW1 - it's possible that she's just not a facebook type person.  Maybe she should change her settings so she doesn't get the updates and photos.  That way she can look at their page if she feels like it but she won't be seeing more than she really wants to know. \n\nI have to agree though that writing about awesome presents you received or how much you really love, love, love your awesome BF, or telling everyone about your Valentines plans - seems a little like what CH called over sharing.  I guess because it's not the kind of the info that I would think about announcing.  For example, if my husband gives me an awesome gift - I don't rush to the phone to call everyone I know and tell them or even do a mass email to let everyone know.  Same with plans for special occasions.  \n\nIf someone asks me - then of course I'll tell them.  But the announcing to the world thing does seem a little over the top when it comes to things like that.  But then, that...</td>
</tr>
<tr>
<th>4214</th>
<td>267</td>
<td>0</td>
<td>20120618211714Z</td>
<td>"Fucking idiots. They should all be in jail. Make things worse for all of us responsible and respectful cyclists."</td>
</tr>
<tr>
<th>3686</th>
<td>3686</td>
<td>0</td>
<td>20120530001221Z</td>
<td>"What's he going to say? "Nope sorry. Next question.". Then they would of criticized him for not answering a simple question. its lose-lose for him."</td>
</tr>
<tr>
<th>4211</th>
<td>264</td>
<td>0</td>
<td>NaN</td>
<td>"He had the potential but blew every one of his chances.\\n\\n \\n\\nNot good enough for Arsenal and he'll not be missed.\\n\\n \\n\\nI expect him to be at Spurs in 10 years or so."</td>
</tr>
<tr>
<th>3483</th>
<td>3483</td>
<td>1</td>
<td>20120609175054Z</td>
<td>"You really are NOTHING but an animal, aren't you?\n\nHave a nice day, I sincerely hope you manage to get some help for your anger issues.\n\nYou are OBVIOUSLY DEEPLY DISTURBED and you have my sympathy."</td>
</tr>
<tr>
<th>3275</th>
<td>3275</td>
<td>0</td>
<td>20120609182832Z</td>
<td>"I like politicians who wear their biases on their sleeves *much* better than the slick ones, who say only what the crowd before them wants to hear.\n\nLike *both* Presidential nominees this go round, and like Governor McDonnell of Virginia.\n\nMcDonnell has his vision set on higher office, and doesn't want to fuck it up right now."</td>
</tr>
<tr>
<th>4589</th>
<td>642</td>
<td>0</td>
<td>20120530141243Z</td>
<td>"One thing that disappointed me about DT last night... since my cable was out I was drawn to the threads and it was disgusting. People on here cussing at brooks, the refs, calling for whole sale changes.\n\xa0\nTo those where in the game thread last night. you should be ashamed. Knee-jerking and lambasting our team for every single thing that didn't go right. Seriously. I expected more from this group.\n\xa0\nyou want to complain? You want to give your advice? Then do that in a constructive manner. The time for debating whole sale changes and coaching extensions and amnestying Perk and what not will come later. But right now lets focus our energy on support OUR TEAM and looking at what they can do to improve.\n\xa0\nTHUNDER UP!"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, we are provided with the text of the comments as well the date the comments were posted. Also the Insult column shows whether the comments is an insult. This is what we are required to predict for the test data.</p>
<p>We also see that the comments are not cleaned. For example the non-breaking spaces appear as "\xa0" and should be removed. Also there characters like "\n" and "\n" which should be replaced by a white space.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Text-Cleaning">Text Cleaning<a class="anchor-link" href="#Text-Cleaning">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We construct a transformer which takes the comments as input and transforms them to cleaned comments:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span>
<span class="kn">from</span> <span class="nn">nltk.stem</span> <span class="kn">import</span> <span class="n">WordNetLemmatizer</span>
<span class="n">wordnet_lemmatizer</span> <span class="o">=</span> <span class="n">WordNetLemmatizer</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">Preprocessor</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
        
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">comments_clean</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'</span><span class="se">\\\\</span><span class="s1">'</span><span class="p">,</span> <span class="s1">'</span><span class="se">\\</span><span class="s1">'</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'</span><span class="se">\\</span><span class="s1">n'</span><span class="p">,</span> <span class="s1">' '</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'http[s]?://[^\s]*'</span><span class="p">,</span> <span class="s1">' '</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'</span><span class="se">\\</span><span class="s1">x[0-9a-f]{2}'</span><span class="p">,</span> <span class="s1">' '</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'</span><span class="se">\\</span><span class="s1">u[0-9a-f]{4}'</span><span class="p">,</span> <span class="s1">' '</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[-"]'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[:*#%&amp;,.?!</span><span class="se">\'</span><span class="s1">]'</span><span class="p">,</span> <span class="s1">' '</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">"(.)\1{2,}"</span><span class="p">,</span> <span class="s1">'\g&lt;1&gt;'</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="c1">#c = re.sub(r'@[^ ]*', ' ', c)</span>
            <span class="c1">#c = re.sub(r'[0-9]+', ' ', c)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">wordnet_lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="n">wordnet_lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="s1">'v'</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> 
                          <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>

            <span class="c1">#c = " ".join([w.lower() for w in c.split()])# if 3&lt;=len(w)&lt;=40])</span>
            <span class="n">comments_clean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">comments_clean</span>
    
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">Preprocessor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The transformer above performs the following cleaning operations on the data:</p>
<ul>
<li>remove double-scape and carriage-return using <code>c = c.replace('\\\\', '\\')</code> and <code>c = c.replace('\\n', ' ')</code> </li>
<li>remove urls using <code>c = re.sub(r'http[s]?://[^\s]*', ' ', c)</code></li>
<li>remove punctuation using <code>c = re.sub(r'[:*#%&amp;,.?!\']', ' ', c)</code></li>
<li>remove non-ascii and unicode characters using <code>c = re.sub(r'\\x[0-9a-f]{2}', ' ', c)</code> and <code>c = re.sub(r'\\u[0-9a-f]{4}', ' ', c)</code></li>
<li>replace repeated characters with a single character so that e.g. word "heeelllll" will be converted to "hell"</li>
<li>replace each word with its lemmatized version and convert all words to lower case</li>
</ul>
<p>Here we can see the original and cleaned comments side-by-side.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">train_sample</span> <span class="o">=</span> <span class="n">train_total</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">train_sample</span><span class="p">[</span><span class="s1">'Comment_clean'</span><span class="p">]</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_sample</span><span class="p">[</span><span class="s1">'Comment'</span><span class="p">])</span>
<span class="n">train_sample</span><span class="p">[[</span><span class="s1">'Comment'</span><span class="p">,</span> <span class="s1">'Comment_clean'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt"></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Comment</th>
<th>Comment_clean</th>
</tr>
</thead>
<tbody>
<tr>
<th>6378</th>
<td>"I wear Gucci, I wear Prada, at the same damn time!"</td>
<td>i wear gucci i wear prada at the same damn time</td>
</tr>
<tr>
<th>6169</th>
<td>"The D-Bags are absolutely atrocious from top to bottom - horrific pitching and zero offense."</td>
<td>the dbags be absolutely atrocious from top to bottom horrific pitch and zero offense</td>
</tr>
<tr>
<th>6104</th>
<td>"All of y'all sound like some lil bitches! Yeezy this ...Yeezy that...are they gonna...are they not gonna drop....man shut the fuck already. Every last one of y'all acting like some hypebeats. Pull your skirts down and your pants up and stop wettin yourself for a fuckin pair of shoes!"</td>
<td>all of y all sound like some lil bitch yeezy this yeezy that be they gonna be they not gonna drop man shut the fuck already every last one of y all act like some hypebeats pull your skirt down and your pant up and stop wettin yourself for a fuckin pair of shoe</td>
</tr>
<tr>
<th>6325</th>
<td>"LOL...Why are you wasting your time reading the comments?"</td>
<td>lol why be you waste your time read the comment</td>
</tr>
<tr>
<th>432</th>
<td>"@daredevil241\xa0\xa0@tomislavgrujic\xa0yea well when you do make sure you punch him with your right hand otherwise it might not be authentic enough for him"</td>
<td>@daredevil241 @tomislavgrujic yea well when you do make sure you punch him with your right hand otherwise it might not be authentic enough for him</td>
</tr>
<tr>
<th>4119</th>
<td>"you are a mental midget you can't be\xa0 a traitor if you aren't a citizen."</td>
<td>you be a mental midget you can t be a traitor if you aren t a citizen</td>
</tr>
<tr>
<th>2822</th>
<td>"you're not stupid, just dumb"</td>
<td>you re not stupid just dumb</td>
</tr>
<tr>
<th>5952</th>
<td>"GET YER TOWELS READY, ROENICK'S WARMING UP THE TEAR DUCTS"</td>
<td>get yer towels ready roenick s warming up the tear ducts</td>
</tr>
<tr>
<th>5224</th>
<td>"He should be deported immediately, along with any others who would do us harm. And if the ECHR don't like it, tough. And when Britain really was Great, he would have been. But I am fully aware that our government haven't got what it takes to put the safety of the British people above kowtowing to Europe."</td>
<td>he should be deport immediately along with any others who would do u harm and if the echr don t like it tough and when britain really be great he would have be but i be fully aware that our government haven t get what it take to put the safety of the british people above kowtow to europe</td>
</tr>
<tr>
<th>352</th>
<td>"suck a dick pussy ass nigga bitch!!!"</td>
<td>suck a dick pussy as nigga bitch</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Feature-Extraction">Feature Extraction<a class="anchor-link" href="#Feature-Extraction">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The most common way to extract feature from text is text vectorization. In this approach, first a bag-of-word representation of the documents is build which contains all the words that appear in any of the documents. Then the number of times each word appears in a document is calculated and is used as a feature vector to represent the document. Optionally, we can divide the word counts by the frequency of each word appearing in all the documents combine. This allows us to reduce the effect of very common words which do not convey much information. A detailed explanation of text vectorization techniques can be found <a href="http://scikit-learn.org/stable/modules/feature_extraction.html">here</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="n">tfidv_char</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">analyzer</span><span class="o">=</span><span class="s1">'char'</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">'english'</span><span class="p">)</span>
<span class="n">tfidv_word</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">analyzer</span><span class="o">=</span><span class="s1">'word'</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">'english'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In its plain form, text vectorization only considers word frequency and does not take into account the position of words relative to each other. In other words, it does not take into account the text "context". To alleviate this problem, as seen above, we can use the ngram_range parameter of the vectorizer. We also note that to extract richer set of features, we have used two vectorizers, one that works of words and one that works on characters.</p>
<p>In addition to standard features, we develop the following feature extractor transformer which extract features that are directly related to the problem of insult detection. This transformer extracts the following features:</p>
<ul>
<li>The count of bad words used the in comment.</li>
<li>The number of positional tags such as verb, noun, adjective, etc, obtained using ntlk.</li>
<li>The number of at mentions in the comment since we are asked to detect insults directed to other members as apposed to public figures like politicians or celebrities.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">word_tokenize</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>

<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span>
<span class="k">class</span> <span class="nc">FeatureExtractor</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'bad_words.txt'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">badwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
        
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fit_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">pos_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"VB"</span><span class="p">,</span> <span class="s2">"JJ"</span><span class="p">,</span> <span class="s2">"RB"</span><span class="p">,</span> <span class="s2">"NN"</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">pos_tag_count</span><span class="p">(</span><span class="n">comment</span><span class="p">):</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">pos_tag</span><span class="p">(</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">comment</span><span class="p">))</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">pos_tags</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">pos_tags</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">tag</span><span class="p">):</span>
                        <span class="n">d</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    
        <span class="k">def</span> <span class="nf">bad_word_count</span><span class="p">(</span><span class="n">comment</span><span class="p">):</span>
            <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">comment</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">badwords</span><span class="p">:</span>
                    <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">cnt</span>
        
        <span class="k">def</span> <span class="nf">at_mention_count</span><span class="p">(</span><span class="n">comment</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'@[^\s]+'</span><span class="p">,</span> <span class="n">comment</span><span class="p">))</span>
        
        <span class="n">comments_features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
            <span class="n">features</span> <span class="o">=</span> <span class="n">pos_tag_count</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bad_word_count</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
            <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">at_mention_count</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
            <span class="n">comments_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">comments_features</span><span class="p">)</span>
                    
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next step is to combine the extracted features using FeatureUnion and create a pipeline which consists of preprocessing and cleaning, feature extraction, and classification.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">FeatureUnion</span>

<span class="n">tfidv_char</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">analyzer</span><span class="o">=</span><span class="s1">'char'</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">'english'</span><span class="p">,</span> <span class="n">min_df</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">tfidv_word</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">analyzer</span><span class="o">=</span><span class="s1">'word'</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">'english'</span><span class="p">,</span> <span class="n">min_df</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fe</span> <span class="o">=</span> <span class="n">FeatureExtractor</span><span class="p">()</span>

<span class="n">fu</span> <span class="o">=</span> <span class="n">FeatureUnion</span><span class="p">([(</span><span class="s1">'fe'</span><span class="p">,</span> <span class="n">fe</span><span class="p">),</span> <span class="p">(</span><span class="s1">'tfidv_char'</span><span class="p">,</span> <span class="n">tfidv_char</span><span class="p">),</span> <span class="p">(</span><span class="s1">'tfidv_word'</span><span class="p">,</span> <span class="n">tfidv_word</span><span class="p">)])</span>
<span class="c1">#clf_rf = RandomForestClassifier()</span>
<span class="n">clf_rf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">estimators</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">'prep'</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span> <span class="p">(</span><span class="s1">'fu'</span><span class="p">,</span> <span class="n">fu</span><span class="p">),</span> <span class="p">(</span><span class="s1">'clf'</span><span class="p">,</span> <span class="n">clf_rf</span><span class="p">)]</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">estimators</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The metric used for the competition is ROC AUC score which can be calculated as follows.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>

<span class="k">def</span> <span class="nf">scoring</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the scoring metric we can calculated the performance our pipeline using cross-validation:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>

<span class="n">cross_val_score</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">train_total</span><span class="o">.</span><span class="n">Comment</span><span class="p">,</span> <span class="n">train_total</span><span class="o">.</span><span class="n">Insult</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt"></div>
<div class="output_text output_subarea output_execute_result">
<pre>array([ 0.89348157,  0.89643174,  0.90271682])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The validation score looks great and have small variations across the cross-validation folds. But we should keep in mind that this is out local validation score and does not necessarily translate directly to leader-board score. Nevertheless, we can use the local score as a proxy for the leader board score and employ it to improve the classification performance.</p>
<p>In the following we use grid-search to perform an exhaustive search over a range of parameters for feature extraction and classification steps in out data pipeline.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'clf__C'</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
              <span class="s1">'fu__tfidv_word__ngram_range'</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span>
              <span class="s1">'fu__tfidv_char__ngram_range'</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>
              <span class="s1">'fu__tfidv_char__min_df'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
              <span class="s1">'fu__tfidv_char__stop_words'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'english'</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
             <span class="p">}</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_total</span><span class="o">.</span><span class="n">Comment</span><span class="p">,</span> <span class="n">train_total</span><span class="o">.</span><span class="n">Insult</span><span class="p">)</span>

<span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt"></div>
<div class="output_text output_subarea output_execute_result">
<pre>{'clf__C': 3.1622776601683795,
 'fu__tfidv_char__min_df': 4,
 'fu__tfidv_char__ngram_range': (1, 3),
 'fu__tfidv_char__stop_words': 'english',
 'fu__tfidv_word__ngram_range': (1, 2)}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt"></div>
<div class="output_text output_subarea output_execute_result">
<pre>0.9057639823535467</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The fact that we obtain the highest score for the largest values of n_gram parameters suggests that we may be able to gain by increasing this parameter. To explore this we perform the following optimization:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'clf__C'</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
              <span class="s1">'fu__tfidv_word__ngram_range'</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>
              <span class="s1">'fu__tfidv_char__ngram_range'</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)],</span>
              <span class="s1">'fu__tfidv_char__min_df'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span>
              <span class="s1">'fu__tfidv_char__stop_words'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'english'</span><span class="p">],</span>
             <span class="p">}</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_total</span><span class="o">.</span><span class="n">Comment</span><span class="p">,</span> <span class="n">train_total</span><span class="o">.</span><span class="n">Insult</span><span class="p">)</span>

<span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt"></div>
<div class="output_text output_subarea output_execute_result">
<pre>0.90810569784332618</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">x_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">y_data</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s1">'mean_test_score'</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span> <span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="s1">'r-o'</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'n_grams'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'AUC ROC score'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Test-Set-Validation">Test Set Validation<a class="anchor-link" href="#Test-Set-Validation">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We take the model obained using the above optimization as our final model. The next step is to evaluate our model on the test set provided for the competition (called verification set "impermium_verification_labels.csv").</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt"></div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_total</span><span class="o">.</span><span class="n">Comment</span><span class="p">,</span> <span class="n">train_total</span><span class="o">.</span><span class="n">Insult</span><span class="p">)</span>
<span class="n">y_ver_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">verfication_set</span><span class="o">.</span><span class="n">Comment</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y_ver</span> <span class="o">=</span> <span class="n">verfication_set</span><span class="o">.</span><span class="n">Insult</span>

<span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_ver</span><span class="p">,</span> <span class="n">y_ver_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt"></div>
<div class="output_text output_subarea output_execute_result">
<pre>0.8191599995509821</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Out final score is considerably lower than the local validation score of 0.9081. But if turn to the private leaderboard of the competition, we find that the best score was <a href="https://www.kaggle.com/c/detecting-insults-in-social-commentary/leaderboard">0.84248</a>. This means that we have achieved more than 97% of the winning solution score which is great specially considering that we used logistic regression which is not considered a complex classifier. On the plus side however, logistic regression is very fast and efficient which is advantagous when using the model on real world data to classify comments as they are received.</p>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  <div class="tag-cloud">
    <p>
    </p>
  </div>





</article>

    <footer>
    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Data Science Passion ",
  "url" : "",
  "image": "",
  "description": ""
}
</script>

</body>
</html>